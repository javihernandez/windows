/*!
 * Copyright 2018 Raising the Floor - International
 *
 * Licensed under the New BSD license. You may not use this file except in
 * compliance with this License.
 *
 * The R&D leading to these results received funding from the
 * Department of Education - Grant H421A150005 (GPII-APCP). However,
 * these results do not necessarily represent the policy of the
 * Department of Education, and you should not assume endorsement by the
 * Federal Government.
 *
 * You may obtain a copy of the License at
 * https://github.com/GPII/universal/blob/master/LICENSE.txt
*/

using System;
using System.Text;
using System.Runtime.InteropServices;

public class Startup
{
    [DllImport("shlwapi.dll", BestFitMapping = false, CharSet = CharSet.Unicode, ExactSpelling = true, SetLastError = false, ThrowOnUnmappableChar = true)]
    public static extern int SHLoadIndirectString(string pszSource, StringBuilder pszOutBuf, int cchOutBuf, IntPtr ppvReserved);

    static void Main(string[] args)
    {
        string param = args[0];
        StringBuilder outBuff = new StringBuilder(4095);

        int result = SHLoadIndirectString(param, outBuff, outBuff.Capacity, IntPtr.Zero);

        Console.OutputEncoding = System.Text.Encoding.UTF8;
        Console.Write(outBuff.ToString());
    }
}
